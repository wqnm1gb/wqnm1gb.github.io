<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Day10 后端Web实战（员工管理） | 三狗子的博客</title>
<meta name=keywords content="java Web"><meta name=description content='删除员工
删除员工基本信息的时候，也要删除员工的工作经历
各层的职责


Controller层
接收请求参数：DELETE /emps?ids=1,2,3
方式1：通过数组来接收
@DeleteMapping
public Result delete(Integer[] ids){
    // 通过数组的方式接收参数
    log.info("要删除的id是{}", Arrays.toString(ids));
    return Result.success();
}
方式2：通过集合来接收
@DeleteMapping
public Result delete(@RequestParam List<Integer> ids){
    // 通过数组的方式接收参数
    log.info("要删除的id是{}",ids);
    return Result.success();
}
如果想让前端传过来的参数保存到像list这样比较复杂的类型中，需要加上@RequestParam修饰'><meta name=author content="冷漠三狗子丶"><link rel=canonical href=https://wqnm1gb.github.io/posts/day10%E5%90%8E%E7%AB%AFweb%E5%AE%9E%E6%88%98%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86/><link crossorigin=anonymous href=/assets/css/stylesheet.3d688279d829dc24da48acd11f9e33ebea2f39c035e899e1bf4297d8b7aa89b9.css integrity="sha256-PWiCedgp3CTaSKzRH54z6+ovOcA16Jnhv0KX2Leqibk=" rel="preload stylesheet" as=style><link rel=icon href=https://wqnm1gb.github.io/images/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://wqnm1gb.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wqnm1gb.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://wqnm1gb.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://wqnm1gb.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://wqnm1gb.github.io/posts/day10%E5%90%8E%E7%AB%AFweb%E5%AE%9E%E6%88%98%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel=stylesheet><script type=text/javascript async src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["[[","]]"]],processEscapes:!0,processEnvironments:!0,skipTags:["script","noscript","style","textarea","pre"],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var e,t=MathJax.Hub.getAllJax();for(e=0;e<t.length;e+=1)t[e].SourceElement().parentNode.className+=" has-jax"})</script><style>code.has-jax{font:inherit;font-size:100%;background:inherit;border:inherit;color:#515151}</style><meta property="og:title" content="Day10 后端Web实战（员工管理）"><meta property="og:description" content='删除员工
删除员工基本信息的时候，也要删除员工的工作经历
各层的职责


Controller层
接收请求参数：DELETE /emps?ids=1,2,3
方式1：通过数组来接收
@DeleteMapping
public Result delete(Integer[] ids){
    // 通过数组的方式接收参数
    log.info("要删除的id是{}", Arrays.toString(ids));
    return Result.success();
}
方式2：通过集合来接收
@DeleteMapping
public Result delete(@RequestParam List<Integer> ids){
    // 通过数组的方式接收参数
    log.info("要删除的id是{}",ids);
    return Result.success();
}
如果想让前端传过来的参数保存到像list这样比较复杂的类型中，需要加上@RequestParam修饰'><meta property="og:type" content="article"><meta property="og:url" content="https://wqnm1gb.github.io/posts/day10%E5%90%8E%E7%AB%AFweb%E5%AE%9E%E6%88%98%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86/"><meta property="og:image" content="https://wqnm1gb.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-03-06T10:08:55+08:00"><meta property="article:modified_time" content="2025-03-06T10:08:55+08:00"><meta property="og:site_name" content="三狗子的博客"><meta property="fb:admins" content="your-facebook-admin-id"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wqnm1gb.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Day10 后端Web实战（员工管理）","item":"https://wqnm1gb.github.io/posts/day10%E5%90%8E%E7%AB%AFweb%E5%AE%9E%E6%88%98%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Day10 后端Web实战（员工管理）","name":"Day10 后端Web实战（员工管理）","description":"删除员工 删除员工基本信息的时候，也要删除员工的工作经历\n各层的职责 Controller层 接收请求参数：DELETE /emps?ids=1,2,3\n方式1：通过数组来接收 @DeleteMapping public Result delete(Integer[] ids){ // 通过数组的方式接收参数 log.info(\u0026#34;要删除的id是{}\u0026#34;, Arrays.toString(ids)); return Result.success(); } 方式2：通过集合来接收 @DeleteMapping public Result delete(@RequestParam List\u0026lt;Integer\u0026gt; ids){ // 通过数组的方式接收参数 log.info(\u0026#34;要删除的id是{}\u0026#34;,ids); return Result.success(); } 如果想让前端传过来的参数保存到像list这样比较复杂的类型中，需要加上@RequestParam修饰\n","keywords":["java Web"],"articleBody":"删除员工 删除员工基本信息的时候，也要删除员工的工作经历\n各层的职责 Controller层 接收请求参数：DELETE /emps?ids=1,2,3\n方式1：通过数组来接收 @DeleteMapping public Result delete(Integer[] ids){ // 通过数组的方式接收参数 log.info(\"要删除的id是{}\", Arrays.toString(ids)); return Result.success(); } 方式2：通过集合来接收 @DeleteMapping public Result delete(@RequestParam List\u003cInteger\u003e ids){ // 通过数组的方式接收参数 log.info(\"要删除的id是{}\",ids); return Result.success(); } 如果想让前端传过来的参数保存到像list这样比较复杂的类型中，需要加上@RequestParam修饰\n一般会封装到list集合中，方便进行开发\n记得要指定分隔符啊！！！\nService层 @Transactional(rollbackFor = Exception.class) @Override public void deleteByIds(List\u003cInteger\u003e ids) { // 删除员工基本信息 empMapper.deleteByIds(ids); // 删除员工工作经历 empExprMapper.deleteByEmpIds(ids); } 事物控制，一定要全部执行完\nMapper层 删除工作经历\n\u003cdelete id=\"deleteByEmpIds\"\u003e delete from emp_expr where emp_id in \u003cforeach collection=\"empIds\" item=\"empId\" separator=\",\" open=\"(\" close=\")\"\u003e #{empId} \u003c/foreach\u003e \u003c/delete\u003e collection：指定遍历的集合名字\nitem：遍历出来的对象的名字\nseparator：分隔符\nopen：开始前需要的符号\nclose：结束后需要的符号\n删除工作基本信息\n\u003cdelete id=\"deleteByIds\"\u003e delete from emp where id in \u003cforeach collection=\"ids\" item=\"id\" separator=\",\" open=\"(\" close=\")\"\u003e #{id} \u003c/foreach\u003e \u003c/delete\u003e 修改员工 查询回显 三层架构 Controller层 @GetMapping(\"/{id}\") public Result getById(@PathVariable Integer id){ log.info(\"想要查询的id是{}\",id); Emp emp = empService.getById(id); return Result.success(emp); } 注意这里传递的是路径参数，必须要用@PathVariable参数指定，但是里边的value值可以省略，如果接受参数和定义的参数名字一样的话\nService层 @Override public Emp getById(Integer id) { Emp emp = empMapper.getById(id); return emp; } 没啥好说的，就是很普通的调用Mapper层\nMapper层 \u003cresultMap id=\"findId\" type=\"com.zzzzyj.pojo.Emp\" \u003e \u003cid column=\"id\" property=\"id\"/\u003e \u003cresult column=\"username\" property=\"username\"/\u003e \u003cresult column=\"password\" property=\"password\"/\u003e \u003cresult column=\"name\" property=\"name\"/\u003e \u003cresult column=\"gender\" property=\"gender\"/\u003e \u003cresult column=\"phone\" property=\"phone\"/\u003e \u003cresult column=\"job\" property=\"job\"/\u003e \u003cresult column=\"salary\" property=\"salary\"/\u003e \u003cresult column=\"image\" property=\"image\"/\u003e \u003cresult column=\"entry_date\" property=\"entryDate\"/\u003e \u003cresult column=\"dept_id\" property=\"deptId\"/\u003e \u003cresult column=\"create_time\" property=\"createTime\"/\u003e \u003cresult column=\"update_time\" property=\"updateTime\"/\u003e \u003ccollection property=\"exprList\" ofType=\"com.zzzzyj.pojo.EmpExpr\"\u003e \u003cid column=\"ee_id\" property=\"id\"/\u003e \u003cresult column=\"ee_emp_id\" property=\"empId\"/\u003e \u003cresult column=\"ee_begin\" property=\"begin\"/\u003e \u003cresult column=\"ee_end\" property=\"end\"/\u003e \u003cresult column=\"ee_company\" property=\"company\"/\u003e \u003cresult column=\"ee_job\" property=\"job\"/\u003e \u003c/collection\u003e \u003c/resultMap\u003e \u003cselect id=\"getById\" resultMap=\"findId\"\u003e select e.*,ee.id ee_id,ee.emp_id ee_emp_id , ee.begin ee_begin , ee.end ee_end , ee.company ee_company , ee.job ee_job from emp e left join emp_expr ee on e.id = ee.emp_id where e.id = #{id}; \u003c/select\u003e Mybatis中封装查询结果，什么时候用 resultType，什么时候用resul Map？\n• 如果查询返回的字段名与实体的属性名可以直接对应上，用resultType。\n• 如果查询返回的字段名与实体的属性名对应不上，或实体属性比较复杂，可以通过resultMap手\n动封装。\n主键用来封装，其他的普通类型用封装\ncolum表示要查询的字段，property表示要封装到的地方\n封装集合的标签是\n修改数据 Controller层 @PutMapping public Result updateById(@RequestBody Emp emp){ log.info(\"修改的员工数据是{}\",emp); empService.updateById(emp); return Result.success(); } 这里没什么特殊的，就是普通的调用Service层，但是注意，由于传来的JSON格式的数据，接收的时候请加上@RequestBody\nService层 @Override public void updateById(Emp emp) { // 更新员工基本信息 emp.setUpdateTime(LocalDateTime.now()); empMapper.updateById(emp); // 更新员工工作经历信息 // 1、先删除之前的信息 empExprMapper.deleteByEmpIds(Arrays.asList(emp.getId())); List\u003cEmpExpr\u003e exprList = emp.getExprList(); if(!CollectionUtils.isEmpty(exprList)){ // 如果不是空的，需要赋值给empId for (EmpExpr empExpr : exprList) { empExpr.setEmpId(emp.getId()); } // 2、更新新增的工作经历信息 empExprMapper.insertBatch(exprList); } } 这里注意，要怎么更新工作经历信息呢，修改工作经历的最好方法是先删再加，就是先把数据都删了，在根据输入的数据增加，因为给出的数据可能会不定的改变，注意增加工作经历的时候，传过来的JSON的数据，是没有员工Id信息的，所以需要先判断员工工作经历是否为空，如果不为空，需要为员工id赋值\n这里需要注意的点：删除可以所以有人都删除，但是增加一定要确保有工作经历再添加！\nMapper层 \u003cupdate id=\"updateById\"\u003e update emp set username = #{username} , password = #{password},name = #{name}, gender= #{gender},phone = #{phone}, job=#{job},salary=#{salary},image=#{image}, entry_date=#{entryDate},dept_id=#{deptId},update_time=#{updateTime} where id = #{id}; \u003c/update\u003e 没啥好讲的，就是普通的update语句，记得update的格式 update 表名 set 字段名=新的值 where 修改的条件\n还有一个思考：之前想的如果我不改密码，是不是密码传递过去会为空值，事实上不是这样的，如果不改动的话，由于信息是查询过来的，所以是不会改变的，只有改变前端更改的值，才会记录到新的Emp中，如果没有更改就是之前的值，但是还是更建议用动态SQL\n动态SQL\n\u003cupdate id=\"updateById\"\u003e update emp \u003cset\u003e \u003cif test=\"username != null and username!= ''\"\u003eusername = #{username},\u003c/if\u003e \u003cif test=\"password != null and password!= ''\"\u003epassword = #{password},\u003c/if\u003e \u003cif test=\"name != null and name!= ''\"\u003ename = #{name},\u003c/if\u003e \u003cif test=\"gender != null\"\u003egender = #{gender},\u003c/if\u003e \u003cif test=\"phone != null and phone != ''\"\u003ephone = #{phone},\u003c/if\u003e \u003cif test=\"job != null\"\u003ejob = #{job},\u003c/if\u003e \u003cif test=\"salary != null\"\u003esalary = #{salary},\u003c/if\u003e \u003cif test=\"image != null and image != ''\"\u003eimage = #{image},\u003c/if\u003e \u003cif test=\"entryDate != null\"\u003eentry_date = #{entryDate},\u003c/if\u003e \u003cif test=\"deptId != null\"\u003edept_id = #{deptId},\u003c/if\u003e \u003cif test=\"updateTime != null\"\u003eupdate_time = #{updateTime},\u003c/if\u003e \u003c/set\u003e where id = #{id} \u003c/update\u003e Mybatis中的标签，会自动生成set关键字，而且会自动删除掉更新后多余的,\n异常处理 如果项目出现异常，会一层一层往调用他的层抛出\n方式1：try-catch 代码臃肿，不推荐\n方式2：全局异常处理器 全局异常处理器的两个注解\n1、类上的@RestControllerAdvice=@ControllerAdvice + @ResponseBody\n2、方法上的@ExceptionHandler\n一般异常处理会放在一个单独的包中\n寻找异常的匹配是从下往上找，找到第一个匹配的类\n@ExceptionHandler public Result HandlerException(Exception e){ log.error(\"出错了\",e); return Result.error(\"服务器故障，请稍后再试\"); } @ExceptionHandler public Result HandlerDuplicateKeyException(DuplicateKeyException e){ log.error(\"出错了\",e); String msg = e.getMessage(); int duplicateEntry = msg.indexOf(\"Duplicate entry\"); String substring = msg.substring(duplicateEntry); String[] s = substring.split(\" \"); return Result.error(s[2]+\"已存在\"); } 员工信息统计 职位统计 用的是Echarts图表\n首先根据接口文档发现需要传输的数据是 所以可以传递两个list集合回去\n不指定list的类型就是可以传递所有的类型，但是不够安全\n三层的职责 Controller层 @GetMapping(\"/empJobData\") public Result getEmpJobData(){ log.info(\"统计各个员工数量\"); JobOption jobOption = reportService.getEmpJobData(); return Result.success(jobOption); } 没啥好说的，就是简单的调用了Service层\nService层 @Override public JobOption getEmpJobData() { List\u003cMap\u003cString, Object\u003e\u003e mapList = empMapper.countJob(); // 这里拿到的流是一个一个的Map集合 List\u003cObject\u003e jobList = mapList.stream().map(datamap -\u003e datamap.get(\"pos\")).toList(); List\u003cObject\u003e dataList = mapList.stream().map(datamap -\u003e datamap.get(\"count\")).toList(); JobOption jobOption = new JobOption(jobList, dataList); return jobOption; } 这里分析一下：\n通过Mapper层拿到的是什么数据？\n定义了List","wordCount":"2977","inLanguage":"zh","image":"https://wqnm1gb.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2025-03-06T10:08:55+08:00","dateModified":"2025-03-06T10:08:55+08:00","author":{"@type":"Person","name":"冷漠三狗子丶"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wqnm1gb.github.io/posts/day10%E5%90%8E%E7%AB%AFweb%E5%AE%9E%E6%88%98%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86/"},"publisher":{"@type":"Organization","name":"三狗子的博客","logo":{"@type":"ImageObject","url":"https://wqnm1gb.github.io/images/favicon.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wqnm1gb.github.io/ accesskey=h title="主页 (Alt + H)"><img src=https://wqnm1gb.github.io/apple-touch-icon.png alt aria-label=logo height=35>主页</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wqnm1gb.github.io/ title=三狗子的博客><span>首页</span></a></li><li><a href=https://wqnm1gb.github.io/archives/ title=归档><span>归档</span></a></li><li><a href=https://wqnm1gb.github.io/categories/ title=Categories><span>分类</span></a></li><li><a href=https://wqnm1gb.github.io/tags/ title=Tags><span>标签</span></a></li><li><a href=https://wqnm1gb.github.io/search/ title=搜索><span>搜索</span></a></li><li><a href=https://wqnm1gb.github.io/about/ title=关于><span>关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wqnm1gb.github.io/>主页</a>&nbsp;»&nbsp;<a href=https://wqnm1gb.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Day10 后端Web实战（员工管理）</h1><div class=post-meta><span title='2025-03-06 10:08:55 +0800 +0800'>三月 6, 2025</span>&nbsp;·&nbsp;6 分钟&nbsp;·&nbsp;2977 字&nbsp;·&nbsp;冷漠三狗子丶</div></header><div class=post-content><h1 id=删除员工>删除员工<a hidden class=anchor aria-hidden=true href=#删除员工>#</a></h1><p>删除员工基本信息的时候，也要删除员工的<strong>工作经历</strong></p><h2 id=各层的职责>各层的职责<a hidden class=anchor aria-hidden=true href=#各层的职责>#</a></h2><p><img loading=lazy src=/images/Day10%e5%90%8e%e7%ab%afWeb%e5%ae%9e%e6%88%98%ef%bc%88%e5%91%98%e5%b7%a5%e7%ae%a1%e7%90%86%ef%bc%89.assets/1734397133960-7907666e-107f-466c-83b7-767b1af6e49c.png alt></p><h2 id=controller层>Controller层<a hidden class=anchor aria-hidden=true href=#controller层>#</a></h2><p>接收请求参数：DELETE /emps?ids=1,2,3</p><h3 id=方式1通过数组来接收>方式1：通过数组来接收<a hidden class=anchor aria-hidden=true href=#方式1通过数组来接收>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@DeleteMapping</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>Result</span><span class=w> </span><span class=nf>delete</span><span class=p>(</span><span class=n>Integer</span><span class=o>[]</span><span class=w> </span><span class=n>ids</span><span class=p>){</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 通过数组的方式接收参数</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>log</span><span class=p>.</span><span class=na>info</span><span class=p>(</span><span class=s>&#34;要删除的id是{}&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Arrays</span><span class=p>.</span><span class=na>toString</span><span class=p>(</span><span class=n>ids</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>Result</span><span class=p>.</span><span class=na>success</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h3 id=方式2通过集合来接收>方式2：通过集合来接收<a hidden class=anchor aria-hidden=true href=#方式2通过集合来接收>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@DeleteMapping</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>public</span><span class=w> </span><span class=n>Result</span><span class=w> </span><span class=nf>delete</span><span class=p>(</span><span class=nd>@RequestParam</span><span class=w> </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span><span class=w> </span><span class=n>ids</span><span class=p>){</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c1>// 通过数组的方式接收参数</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>log</span><span class=p>.</span><span class=na>info</span><span class=p>(</span><span class=s>&#34;要删除的id是{}&#34;</span><span class=p>,</span><span class=n>ids</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>Result</span><span class=p>.</span><span class=na>success</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>如果想让前端传过来的参数保存到像list这样比较复杂的类型中，需要加上@RequestParam修饰</p><p>一般会封装到list集合中，方便进行开发</p><p>记得要指定分隔符啊！！！</p><h2 id=service层>Service层<a hidden class=anchor aria-hidden=true href=#service层>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=nd>@Transactional</span><span class=p>(</span><span class=n>rollbackFor</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Exception</span><span class=p>.</span><span class=na>class</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>deleteByIds</span><span class=p>(</span><span class=n>List</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span><span class=w> </span><span class=n>ids</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 删除员工基本信息</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>empMapper</span><span class=p>.</span><span class=na>deleteByIds</span><span class=p>(</span><span class=n>ids</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 删除员工工作经历</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>empExprMapper</span><span class=p>.</span><span class=na>deleteByEmpIds</span><span class=p>(</span><span class=n>ids</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>事物控制，一定要全部执行完</p><h2 id=mapper层>Mapper层<a hidden class=anchor aria-hidden=true href=#mapper层>#</a></h2><p><strong>删除工作经历</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=o>&lt;</span><span class=n>delete</span><span class=w> </span><span class=n>id</span><span class=o>=</span><span class=s>&#34;deleteByEmpIds&#34;</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>delete</span><span class=w> </span><span class=n>from</span><span class=w> </span><span class=n>emp_expr</span><span class=w> </span><span class=n>where</span><span class=w> </span><span class=n>emp_id</span><span class=w> </span><span class=n>in</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&lt;</span><span class=n>foreach</span><span class=w> </span><span class=n>collection</span><span class=o>=</span><span class=s>&#34;empIds&#34;</span><span class=w> </span><span class=n>item</span><span class=o>=</span><span class=s>&#34;empId&#34;</span><span class=w> </span><span class=n>separator</span><span class=o>=</span><span class=s>&#34;,&#34;</span><span class=w> </span><span class=n>open</span><span class=o>=</span><span class=s>&#34;(&#34;</span><span class=w> </span><span class=n>close</span><span class=o>=</span><span class=s>&#34;)&#34;</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=err>#</span><span class=p>{</span><span class=n>empId</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&lt;/</span><span class=n>foreach</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>&lt;/</span><span class=n>delete</span><span class=o>&gt;</span><span class=w>
</span></span></span></code></pre></div><p>collection：指定遍历的集合名字</p><p>item：遍历出来的对象的名字</p><p>separator：分隔符</p><p>open：开始前需要的符号</p><p>close：结束后需要的符号</p><p><strong>删除工作基本信息</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=o>&lt;</span><span class=n>delete</span><span class=w> </span><span class=n>id</span><span class=o>=</span><span class=s>&#34;deleteByIds&#34;</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>delete</span><span class=w> </span><span class=n>from</span><span class=w> </span><span class=n>emp</span><span class=w> </span><span class=n>where</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=n>in</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=o>&lt;</span><span class=n>foreach</span><span class=w> </span><span class=n>collection</span><span class=o>=</span><span class=s>&#34;ids&#34;</span><span class=w> </span><span class=n>item</span><span class=o>=</span><span class=s>&#34;id&#34;</span><span class=w> </span><span class=n>separator</span><span class=o>=</span><span class=s>&#34;,&#34;</span><span class=w> </span><span class=n>open</span><span class=o>=</span><span class=s>&#34;(&#34;</span><span class=w> </span><span class=n>close</span><span class=o>=</span><span class=s>&#34;)&#34;</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=err>#</span><span class=p>{</span><span class=n>id</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=o>&lt;/</span><span class=n>foreach</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>&lt;/</span><span class=n>delete</span><span class=o>&gt;</span><span class=w>
</span></span></span></code></pre></div><h1 id=修改员工>修改员工<a hidden class=anchor aria-hidden=true href=#修改员工>#</a></h1><h2 id=查询回显>查询回显<a hidden class=anchor aria-hidden=true href=#查询回显>#</a></h2><h3 id=三层架构>三层架构<a hidden class=anchor aria-hidden=true href=#三层架构>#</a></h3><p><img loading=lazy src=/images/Day10%e5%90%8e%e7%ab%afWeb%e5%ae%9e%e6%88%98%ef%bc%88%e5%91%98%e5%b7%a5%e7%ae%a1%e7%90%86%ef%bc%89.assets/1734403948262-cffb36e9-0106-45fd-90a2-769fbc986e51.png alt></p><h3 id=controller层-1>Controller层<a hidden class=anchor aria-hidden=true href=#controller层-1>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/{id}&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Result</span><span class=w> </span><span class=nf>getById</span><span class=p>(</span><span class=nd>@PathVariable</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>id</span><span class=p>){</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>log</span><span class=p>.</span><span class=na>info</span><span class=p>(</span><span class=s>&#34;想要查询的id是{}&#34;</span><span class=p>,</span><span class=n>id</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Emp</span><span class=w> </span><span class=n>emp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>empService</span><span class=p>.</span><span class=na>getById</span><span class=p>(</span><span class=n>id</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>Result</span><span class=p>.</span><span class=na>success</span><span class=p>(</span><span class=n>emp</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>注意这里传递的是路径参数，必须要用@PathVariable参数指定，但是里边的value值可以省略，如果接受参数和定义的参数名字一样的话</p><h3 id=service层-1>Service层<a hidden class=anchor aria-hidden=true href=#service层-1>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Emp</span><span class=w> </span><span class=nf>getById</span><span class=p>(</span><span class=n>Integer</span><span class=w> </span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>Emp</span><span class=w> </span><span class=n>emp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>empMapper</span><span class=p>.</span><span class=na>getById</span><span class=p>(</span><span class=n>id</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>emp</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>没啥好说的，就是很普通的调用Mapper层</p><h3 id=mapper层-1>Mapper层<a hidden class=anchor aria-hidden=true href=#mapper层-1>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=o>&lt;</span><span class=n>resultMap</span><span class=w> </span><span class=n>id</span><span class=o>=</span><span class=s>&#34;findId&#34;</span><span class=w> </span><span class=n>type</span><span class=o>=</span><span class=s>&#34;com.zzzzyj.pojo.Emp&#34;</span><span class=w> </span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>&lt;</span><span class=n>id</span><span class=w> </span><span class=n>column</span><span class=o>=</span><span class=s>&#34;id&#34;</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;id&#34;</span><span class=o>/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>&lt;</span><span class=n>result</span><span class=w> </span><span class=n>column</span><span class=o>=</span><span class=s>&#34;username&#34;</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;username&#34;</span><span class=o>/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>&lt;</span><span class=n>result</span><span class=w> </span><span class=n>column</span><span class=o>=</span><span class=s>&#34;password&#34;</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;password&#34;</span><span class=o>/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>&lt;</span><span class=n>result</span><span class=w> </span><span class=n>column</span><span class=o>=</span><span class=s>&#34;name&#34;</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;name&#34;</span><span class=o>/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>&lt;</span><span class=n>result</span><span class=w> </span><span class=n>column</span><span class=o>=</span><span class=s>&#34;gender&#34;</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;gender&#34;</span><span class=o>/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>&lt;</span><span class=n>result</span><span class=w> </span><span class=n>column</span><span class=o>=</span><span class=s>&#34;phone&#34;</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;phone&#34;</span><span class=o>/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>&lt;</span><span class=n>result</span><span class=w> </span><span class=n>column</span><span class=o>=</span><span class=s>&#34;job&#34;</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;job&#34;</span><span class=o>/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>&lt;</span><span class=n>result</span><span class=w> </span><span class=n>column</span><span class=o>=</span><span class=s>&#34;salary&#34;</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;salary&#34;</span><span class=o>/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>&lt;</span><span class=n>result</span><span class=w> </span><span class=n>column</span><span class=o>=</span><span class=s>&#34;image&#34;</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;image&#34;</span><span class=o>/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>&lt;</span><span class=n>result</span><span class=w> </span><span class=n>column</span><span class=o>=</span><span class=s>&#34;entry_date&#34;</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;entryDate&#34;</span><span class=o>/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>&lt;</span><span class=n>result</span><span class=w> </span><span class=n>column</span><span class=o>=</span><span class=s>&#34;dept_id&#34;</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;deptId&#34;</span><span class=o>/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>&lt;</span><span class=n>result</span><span class=w> </span><span class=n>column</span><span class=o>=</span><span class=s>&#34;create_time&#34;</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;createTime&#34;</span><span class=o>/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>&lt;</span><span class=n>result</span><span class=w> </span><span class=n>column</span><span class=o>=</span><span class=s>&#34;update_time&#34;</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;updateTime&#34;</span><span class=o>/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>&lt;</span><span class=n>collection</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;exprList&#34;</span><span class=w> </span><span class=n>ofType</span><span class=o>=</span><span class=s>&#34;com.zzzzyj.pojo.EmpExpr&#34;</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&lt;</span><span class=n>id</span><span class=w> </span><span class=n>column</span><span class=o>=</span><span class=s>&#34;ee_id&#34;</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;id&#34;</span><span class=o>/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&lt;</span><span class=n>result</span><span class=w> </span><span class=n>column</span><span class=o>=</span><span class=s>&#34;ee_emp_id&#34;</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;empId&#34;</span><span class=o>/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&lt;</span><span class=n>result</span><span class=w> </span><span class=n>column</span><span class=o>=</span><span class=s>&#34;ee_begin&#34;</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;begin&#34;</span><span class=o>/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&lt;</span><span class=n>result</span><span class=w> </span><span class=n>column</span><span class=o>=</span><span class=s>&#34;ee_end&#34;</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;end&#34;</span><span class=o>/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&lt;</span><span class=n>result</span><span class=w> </span><span class=n>column</span><span class=o>=</span><span class=s>&#34;ee_company&#34;</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;company&#34;</span><span class=o>/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&lt;</span><span class=n>result</span><span class=w> </span><span class=n>column</span><span class=o>=</span><span class=s>&#34;ee_job&#34;</span><span class=w> </span><span class=n>property</span><span class=o>=</span><span class=s>&#34;job&#34;</span><span class=o>/&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>&lt;/</span><span class=n>collection</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>&lt;/</span><span class=n>resultMap</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>&lt;!--</span><span class=w>    </span><span class=n>查询员工信息回显</span><span class=o>--&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>&lt;</span><span class=n>select</span><span class=w> </span><span class=n>id</span><span class=o>=</span><span class=s>&#34;getById&#34;</span><span class=w> </span><span class=n>resultMap</span><span class=o>=</span><span class=s>&#34;findId&#34;</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>select</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>e</span><span class=p>.</span><span class=o>*</span><span class=p>,</span><span class=n>ee</span><span class=p>.</span><span class=na>id</span><span class=w> </span><span class=n>ee_id</span><span class=p>,</span><span class=n>ee</span><span class=p>.</span><span class=na>emp_id</span><span class=w> </span><span class=n>ee_emp_id</span><span class=w> </span><span class=p>,</span><span class=w> </span><span class=n>ee</span><span class=p>.</span><span class=na>begin</span><span class=w> </span><span class=n>ee_begin</span><span class=w> </span><span class=p>,</span><span class=w> </span><span class=n>ee</span><span class=p>.</span><span class=na>end</span><span class=w> </span><span class=n>ee_end</span><span class=w> </span><span class=p>,</span><span class=w> </span><span class=n>ee</span><span class=p>.</span><span class=na>company</span><span class=w> </span><span class=n>ee_company</span><span class=w> </span><span class=p>,</span><span class=w> </span><span class=n>ee</span><span class=p>.</span><span class=na>job</span><span class=w> </span><span class=n>ee_job</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=n>from</span><span class=w> </span><span class=n>emp</span><span class=w> </span><span class=n>e</span><span class=w> </span><span class=n>left</span><span class=w> </span><span class=n>join</span><span class=w> </span><span class=n>emp_expr</span><span class=w> </span><span class=n>ee</span><span class=w> </span><span class=n>on</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=na>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ee</span><span class=p>.</span><span class=na>emp_id</span><span class=w> </span><span class=n>where</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=na>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=n>id</span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>&lt;/</span><span class=n>select</span><span class=o>&gt;</span><span class=w>
</span></span></span></code></pre></div><p><strong>Mybatis中封装查询结果，什么时候用 resultType，什么时候用resul Map？</strong></p><p>• 如果查询返回的字段名与实体的属性名<strong>可以直接对应上</strong>，用resultType。</p><p>• 如果查询返回的字段名与实体的属性名<strong>对应不上</strong>，或<strong>实体属性比较复杂</strong>，可以通过resultMap手</p><p>动封装。</p><p><strong>主键用来封装，其他的普通类型用封装</strong></p><p>colum表示要查询的字段，property表示要封装到的地方</p><p><strong>封装集合的标签是</strong></p><h2 id=修改数据>修改数据<a hidden class=anchor aria-hidden=true href=#修改数据>#</a></h2><p><img loading=lazy src=/images/Day10%e5%90%8e%e7%ab%afWeb%e5%ae%9e%e6%88%98%ef%bc%88%e5%91%98%e5%b7%a5%e7%ae%a1%e7%90%86%ef%bc%89.assets/1734406101854-29c44282-307e-4235-9c63-b755f2337eee.png alt></p><h3 id=controller层-2>Controller层<a hidden class=anchor aria-hidden=true href=#controller层-2>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=nd>@PutMapping</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Result</span><span class=w> </span><span class=nf>updateById</span><span class=p>(</span><span class=nd>@RequestBody</span><span class=w> </span><span class=n>Emp</span><span class=w> </span><span class=n>emp</span><span class=p>){</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>log</span><span class=p>.</span><span class=na>info</span><span class=p>(</span><span class=s>&#34;修改的员工数据是{}&#34;</span><span class=p>,</span><span class=n>emp</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>empService</span><span class=p>.</span><span class=na>updateById</span><span class=p>(</span><span class=n>emp</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>Result</span><span class=p>.</span><span class=na>success</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>这里没什么特殊的，就是普通的调用Service层，但是注意，由于传来的JSON格式的数据，接收的时候请加上@RequestBody</p><h3 id=service层-2>Service层<a hidden class=anchor aria-hidden=true href=#service层-2>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>updateById</span><span class=p>(</span><span class=n>Emp</span><span class=w> </span><span class=n>emp</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 更新员工基本信息</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>emp</span><span class=p>.</span><span class=na>setUpdateTime</span><span class=p>(</span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>now</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>empMapper</span><span class=p>.</span><span class=na>updateById</span><span class=p>(</span><span class=n>emp</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 更新员工工作经历信息</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 1、先删除之前的信息</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>empExprMapper</span><span class=p>.</span><span class=na>deleteByEmpIds</span><span class=p>(</span><span class=n>Arrays</span><span class=p>.</span><span class=na>asList</span><span class=p>(</span><span class=n>emp</span><span class=p>.</span><span class=na>getId</span><span class=p>()));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>List</span><span class=o>&lt;</span><span class=n>EmpExpr</span><span class=o>&gt;</span><span class=w> </span><span class=n>exprList</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>emp</span><span class=p>.</span><span class=na>getExprList</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>if</span><span class=p>(</span><span class=o>!</span><span class=n>CollectionUtils</span><span class=p>.</span><span class=na>isEmpty</span><span class=p>(</span><span class=n>exprList</span><span class=p>)){</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 如果不是空的，需要赋值给empId</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=n>EmpExpr</span><span class=w> </span><span class=n>empExpr</span><span class=w> </span><span class=p>:</span><span class=w> </span><span class=n>exprList</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>empExpr</span><span class=p>.</span><span class=na>setEmpId</span><span class=p>(</span><span class=n>emp</span><span class=p>.</span><span class=na>getId</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 2、更新新增的工作经历信息</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>empExprMapper</span><span class=p>.</span><span class=na>insertBatch</span><span class=p>(</span><span class=n>exprList</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>这里注意，要怎么更新工作经历信息呢，修改工作经历的最好方法是<strong>先删再加</strong>，就是先把数据都删了，在根据输入的数据增加，因为给出的数据可能会<strong>不定的改变，注意增加工作经历的时候，传过来的JSON的数据，是没有员工Id信息的，所以需要先判断员工工作经历是否为空，如果不为空，需要为员工id赋值</strong></p><hr><p><strong>这里需要注意的点：<strong><strong>删除可以所以有人都删除，但是增加一定要确保有工作经历再添加</strong></strong>！</strong></p><h3 id=mapper层-2>Mapper层<a hidden class=anchor aria-hidden=true href=#mapper层-2>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=o>&lt;!--</span><span class=w>    </span><span class=n>更新员工信息</span><span class=o>--&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>&lt;</span><span class=n>update</span><span class=w> </span><span class=n>id</span><span class=o>=</span><span class=s>&#34;updateById&#34;</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>update</span><span class=w> </span><span class=n>emp</span><span class=w> </span><span class=n>set</span><span class=w> </span><span class=n>username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=n>username</span><span class=p>}</span><span class=w> </span><span class=p>,</span><span class=w> </span><span class=n>password</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=n>password</span><span class=p>},</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=n>name</span><span class=p>},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                       </span><span class=n>gender</span><span class=o>=</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=n>gender</span><span class=p>},</span><span class=n>phone</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=n>phone</span><span class=p>},</span><span class=w> </span><span class=n>job</span><span class=o>=</span><span class=err>#</span><span class=p>{</span><span class=n>job</span><span class=p>},</span><span class=n>salary</span><span class=o>=</span><span class=err>#</span><span class=p>{</span><span class=n>salary</span><span class=p>},</span><span class=n>image</span><span class=o>=</span><span class=err>#</span><span class=p>{</span><span class=n>image</span><span class=p>},</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                       </span><span class=n>entry_date</span><span class=o>=</span><span class=err>#</span><span class=p>{</span><span class=n>entryDate</span><span class=p>},</span><span class=n>dept_id</span><span class=o>=</span><span class=err>#</span><span class=p>{</span><span class=n>deptId</span><span class=p>},</span><span class=n>update_time</span><span class=o>=</span><span class=err>#</span><span class=p>{</span><span class=n>updateTime</span><span class=p>}</span><span class=w> </span><span class=n>where</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=n>id</span><span class=p>};</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>&lt;/</span><span class=n>update</span><span class=o>&gt;</span><span class=w>
</span></span></span></code></pre></div><p>没啥好讲的，就是普通的update语句，记得update的格式 update 表名 set 字段名=新的值 where 修改的条件</p><p>还有一个思考：之前想的如果我不改密码，是不是密码传递过去会为空值，事实上不是这样的，如果不改动的话，由于<strong>信息是查询过来的</strong>，所以是不会改变的，只有改变前端更改的值，才会记录到新的Emp中，如果没有更改就是之前的值，但是还是更建议用动态SQL</p><p><strong>动态SQL</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=o>&lt;</span><span class=n>update</span><span class=w> </span><span class=n>id</span><span class=o>=</span><span class=s>&#34;updateById&#34;</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>update</span><span class=w> </span><span class=n>emp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>&lt;</span><span class=n>set</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&lt;</span><span class=k>if</span><span class=w> </span><span class=n>test</span><span class=o>=</span><span class=s>&#34;username != null and username!= &#39;&#39;&#34;</span><span class=o>&gt;</span><span class=n>username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=n>username</span><span class=p>},</span><span class=o>&lt;/</span><span class=k>if</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&lt;</span><span class=k>if</span><span class=w> </span><span class=n>test</span><span class=o>=</span><span class=s>&#34;password != null and password!= &#39;&#39;&#34;</span><span class=o>&gt;</span><span class=n>password</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=n>password</span><span class=p>},</span><span class=o>&lt;/</span><span class=k>if</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&lt;</span><span class=k>if</span><span class=w> </span><span class=n>test</span><span class=o>=</span><span class=s>&#34;name != null and name!= &#39;&#39;&#34;</span><span class=o>&gt;</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=n>name</span><span class=p>},</span><span class=o>&lt;/</span><span class=k>if</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&lt;</span><span class=k>if</span><span class=w> </span><span class=n>test</span><span class=o>=</span><span class=s>&#34;gender != null&#34;</span><span class=o>&gt;</span><span class=n>gender</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=n>gender</span><span class=p>},</span><span class=o>&lt;/</span><span class=k>if</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&lt;</span><span class=k>if</span><span class=w> </span><span class=n>test</span><span class=o>=</span><span class=s>&#34;phone != null and phone != &#39;&#39;&#34;</span><span class=o>&gt;</span><span class=n>phone</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=n>phone</span><span class=p>},</span><span class=o>&lt;/</span><span class=k>if</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&lt;</span><span class=k>if</span><span class=w> </span><span class=n>test</span><span class=o>=</span><span class=s>&#34;job != null&#34;</span><span class=o>&gt;</span><span class=n>job</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=n>job</span><span class=p>},</span><span class=o>&lt;/</span><span class=k>if</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&lt;</span><span class=k>if</span><span class=w> </span><span class=n>test</span><span class=o>=</span><span class=s>&#34;salary != null&#34;</span><span class=o>&gt;</span><span class=n>salary</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=n>salary</span><span class=p>},</span><span class=o>&lt;/</span><span class=k>if</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&lt;</span><span class=k>if</span><span class=w> </span><span class=n>test</span><span class=o>=</span><span class=s>&#34;image != null and image != &#39;&#39;&#34;</span><span class=o>&gt;</span><span class=n>image</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=n>image</span><span class=p>},</span><span class=o>&lt;/</span><span class=k>if</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&lt;</span><span class=k>if</span><span class=w> </span><span class=n>test</span><span class=o>=</span><span class=s>&#34;entryDate != null&#34;</span><span class=o>&gt;</span><span class=n>entry_date</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=n>entryDate</span><span class=p>},</span><span class=o>&lt;/</span><span class=k>if</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&lt;</span><span class=k>if</span><span class=w> </span><span class=n>test</span><span class=o>=</span><span class=s>&#34;deptId != null&#34;</span><span class=o>&gt;</span><span class=n>dept_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=n>deptId</span><span class=p>},</span><span class=o>&lt;/</span><span class=k>if</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=o>&lt;</span><span class=k>if</span><span class=w> </span><span class=n>test</span><span class=o>=</span><span class=s>&#34;updateTime != null&#34;</span><span class=o>&gt;</span><span class=n>update_time</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=n>updateTime</span><span class=p>},</span><span class=o>&lt;/</span><span class=k>if</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=o>&lt;/</span><span class=n>set</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>where</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=err>#</span><span class=p>{</span><span class=n>id</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>&lt;/</span><span class=n>update</span><span class=o>&gt;</span><span class=w>
</span></span></span></code></pre></div><p>Mybatis中的标签，会自动生成set关键字，而且会自动删除掉更新后多余的,</p><h1 id=异常处理>异常处理<a hidden class=anchor aria-hidden=true href=#异常处理>#</a></h1><p>如果项目出现异常，会一层一层往调用他的层抛出</p><p><img loading=lazy src=/images/Day10%e5%90%8e%e7%ab%afWeb%e5%ae%9e%e6%88%98%ef%bc%88%e5%91%98%e5%b7%a5%e7%ae%a1%e7%90%86%ef%bc%89.assets/1734488475044-f43b93a2-4e2a-4935-ae9c-c1ac007708df.png alt></p><h3 id=方式1try-catch>方式1：try-catch<a hidden class=anchor aria-hidden=true href=#方式1try-catch>#</a></h3><p>代码臃肿，不推荐</p><p><img loading=lazy src=/images/Day10%e5%90%8e%e7%ab%afWeb%e5%ae%9e%e6%88%98%ef%bc%88%e5%91%98%e5%b7%a5%e7%ae%a1%e7%90%86%ef%bc%89.assets/1734488514278-5502488b-6d70-4924-814b-170c8c678bb2.png alt></p><h3 id=方式2全局异常处理器>方式2：全局异常处理器<a hidden class=anchor aria-hidden=true href=#方式2全局异常处理器>#</a></h3><p><img loading=lazy src=/images/Day10%e5%90%8e%e7%ab%afWeb%e5%ae%9e%e6%88%98%ef%bc%88%e5%91%98%e5%b7%a5%e7%ae%a1%e7%90%86%ef%bc%89.assets/1734488570928-8251fb8f-7f79-4dc2-9b42-bca62bdc3aa8.png alt></p><p><strong>全局异常处理器的两个注解</strong></p><p>1、类上的@RestControllerAdvice=@ControllerAdvice + @ResponseBody</p><p>2、方法上的@ExceptionHandler</p><p>一般异常处理会放在一个单独的包中</p><p>寻找异常的匹配是<strong>从下往上找，找到第一个匹配的类</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=nd>@ExceptionHandler</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Result</span><span class=w> </span><span class=nf>HandlerException</span><span class=p>(</span><span class=n>Exception</span><span class=w> </span><span class=n>e</span><span class=p>){</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>log</span><span class=p>.</span><span class=na>error</span><span class=p>(</span><span class=s>&#34;出错了&#34;</span><span class=p>,</span><span class=n>e</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>Result</span><span class=p>.</span><span class=na>error</span><span class=p>(</span><span class=s>&#34;服务器故障，请稍后再试&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@ExceptionHandler</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Result</span><span class=w> </span><span class=nf>HandlerDuplicateKeyException</span><span class=p>(</span><span class=n>DuplicateKeyException</span><span class=w> </span><span class=n>e</span><span class=p>){</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>log</span><span class=p>.</span><span class=na>error</span><span class=p>(</span><span class=s>&#34;出错了&#34;</span><span class=p>,</span><span class=n>e</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>msg</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>e</span><span class=p>.</span><span class=na>getMessage</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=kt>int</span><span class=w> </span><span class=n>duplicateEntry</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>msg</span><span class=p>.</span><span class=na>indexOf</span><span class=p>(</span><span class=s>&#34;Duplicate entry&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=w> </span><span class=n>substring</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>msg</span><span class=p>.</span><span class=na>substring</span><span class=p>(</span><span class=n>duplicateEntry</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>s</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>substring</span><span class=p>.</span><span class=na>split</span><span class=p>(</span><span class=s>&#34; &#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>Result</span><span class=p>.</span><span class=na>error</span><span class=p>(</span><span class=n>s</span><span class=o>[</span><span class=n>2</span><span class=o>]+</span><span class=s>&#34;已存在&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h1 id=员工信息统计>员工信息统计<a hidden class=anchor aria-hidden=true href=#员工信息统计>#</a></h1><h2 id=职位统计>职位统计<a hidden class=anchor aria-hidden=true href=#职位统计>#</a></h2><p><strong>用的是Echarts图表</strong></p><p>首先根据接口文档发现需要传输的数据是<img loading=lazy src=/images/Day10%e5%90%8e%e7%ab%afWeb%e5%ae%9e%e6%88%98%ef%bc%88%e5%91%98%e5%b7%a5%e7%ae%a1%e7%90%86%ef%bc%89.assets/1734569165809-2d71ec06-7d0f-4924-a563-4a447fdde7c7.png alt></p><p>所以可以传递两个list集合回去</p><p><img loading=lazy src=/images/Day10%e5%90%8e%e7%ab%afWeb%e5%ae%9e%e6%88%98%ef%bc%88%e5%91%98%e5%b7%a5%e7%ae%a1%e7%90%86%ef%bc%89.assets/1734569207438-ca654814-3780-4f9c-9691-ff51fe67fbe6.png alt></p><p><strong>不指定list的类型就是可以传递所有的类型，但是不够安全</strong></p><hr><h3 id=三层的职责>三层的职责<a hidden class=anchor aria-hidden=true href=#三层的职责>#</a></h3><p><img loading=lazy src=/images/Day10%e5%90%8e%e7%ab%afWeb%e5%ae%9e%e6%88%98%ef%bc%88%e5%91%98%e5%b7%a5%e7%ae%a1%e7%90%86%ef%bc%89.assets/1734569319911-53106fef-4579-440f-b438-6c4cd7d706df.png alt></p><h3 id=controller层-3>Controller层<a hidden class=anchor aria-hidden=true href=#controller层-3>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/empJobData&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Result</span><span class=w> </span><span class=nf>getEmpJobData</span><span class=p>(){</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>log</span><span class=p>.</span><span class=na>info</span><span class=p>(</span><span class=s>&#34;统计各个员工数量&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>JobOption</span><span class=w> </span><span class=n>jobOption</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>reportService</span><span class=p>.</span><span class=na>getEmpJobData</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>Result</span><span class=p>.</span><span class=na>success</span><span class=p>(</span><span class=n>jobOption</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>没啥好说的，就是简单的调用了Service层</p><h3 id=service层-3>Service层<a hidden class=anchor aria-hidden=true href=#service层-3>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>JobOption</span><span class=w> </span><span class=nf>getEmpJobData</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>mapList</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>empMapper</span><span class=p>.</span><span class=na>countJob</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 这里拿到的流是一个一个的Map集合</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Object</span><span class=o>&gt;</span><span class=w> </span><span class=n>jobList</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mapList</span><span class=p>.</span><span class=na>stream</span><span class=p>().</span><span class=na>map</span><span class=p>(</span><span class=n>datamap</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>datamap</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=s>&#34;pos&#34;</span><span class=p>)).</span><span class=na>toList</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Object</span><span class=o>&gt;</span><span class=w> </span><span class=n>dataList</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>mapList</span><span class=p>.</span><span class=na>stream</span><span class=p>().</span><span class=na>map</span><span class=p>(</span><span class=n>datamap</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>datamap</span><span class=p>.</span><span class=na>get</span><span class=p>(</span><span class=s>&#34;count&#34;</span><span class=p>)).</span><span class=na>toList</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>JobOption</span><span class=w> </span><span class=n>jobOption</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>JobOption</span><span class=p>(</span><span class=n>jobList</span><span class=p>,</span><span class=w> </span><span class=n>dataList</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>jobOption</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>这里分析一下：</p><p>通过Mapper层拿到的是什么数据？</p><p>定义了List&lt;Map&lt;String,Object&#187;这个数据类型</p><p>得到的mapList集合是：</p><p><img loading=lazy src=/images/Day10%e5%90%8e%e7%ab%afWeb%e5%ae%9e%e6%88%98%ef%bc%88%e5%91%98%e5%b7%a5%e7%ae%a1%e7%90%86%ef%bc%89.assets/1734569536097-94cde120-aaad-477b-8211-dc5ba48921bb.png alt>
一共有6个list集合元素，每个list集合里边包括了两个Map集合，这就是为什么第二个Map需要用Object的原因</p><p>通过Stream流获取的jobList是 jobData是类似的，注意领会Stream中map操作，其实就是对LIst里边的元素进行操作，List里边是啥呀，是map所以可以对map的key取出value</p><p><img loading=lazy src=/images/Day10%e5%90%8e%e7%ab%afWeb%e5%ae%9e%e6%88%98%ef%bc%88%e5%91%98%e5%b7%a5%e7%ae%a1%e7%90%86%ef%bc%89.assets/1734569633008-2068e1e8-7166-4e94-81d4-7274ee34975c.png alt></p><h3 id=mapper层-3>Mapper层<a hidden class=anchor aria-hidden=true href=#mapper层-3>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=o>&lt;!--</span><span class=w>    </span><span class=n>查询员工数量</span><span class=o>--&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>&lt;</span><span class=n>select</span><span class=w> </span><span class=n>id</span><span class=o>=</span><span class=s>&#34;countJob&#34;</span><span class=w> </span><span class=n>resultType</span><span class=o>=</span><span class=s>&#34;java.util.Map&#34;</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>select</span><span class=w> </span><span class=p>(</span><span class=k>case</span><span class=w> </span><span class=n>when</span><span class=w> </span><span class=n>job</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>1</span><span class=w> </span><span class=n>then</span><span class=w> </span><span class=err>&#39;</span><span class=n>班主任</span><span class=err>&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                     </span><span class=n>when</span><span class=w> </span><span class=n>job</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>2</span><span class=w> </span><span class=n>then</span><span class=w> </span><span class=err>&#39;</span><span class=n>讲师</span><span class=err>&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                     </span><span class=n>when</span><span class=w> </span><span class=n>job</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>3</span><span class=w> </span><span class=n>then</span><span class=w> </span><span class=err>&#39;</span><span class=n>学工主管</span><span class=err>&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                     </span><span class=n>when</span><span class=w> </span><span class=n>job</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>4</span><span class=w> </span><span class=n>then</span><span class=w> </span><span class=err>&#39;</span><span class=n>教研主管</span><span class=err>&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                     </span><span class=n>when</span><span class=w> </span><span class=n>job</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>5</span><span class=w> </span><span class=n>then</span><span class=w> </span><span class=err>&#39;</span><span class=n>咨询师</span><span class=err>&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                     </span><span class=k>else</span><span class=w> </span><span class=err>&#39;</span><span class=n>其他</span><span class=err>&#39;</span><span class=w> </span><span class=n>end</span><span class=p>)</span><span class=w> </span><span class=n>pos</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>               </span><span class=n>count</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=n>count</span><span class=w> </span><span class=n>from</span><span class=w> </span><span class=n>emp</span><span class=w> </span><span class=n>group</span><span class=w> </span><span class=n>by</span><span class=w> </span><span class=n>job</span><span class=w> </span><span class=n>order</span><span class=w> </span><span class=n>by</span><span class=w> </span><span class=n>count</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>&lt;/</span><span class=n>select</span><span class=o>&gt;</span><span class=w>
</span></span></span></code></pre></div><p>用到MySQL中的case函数</p><p><strong>第一种形式（只用于等值匹配）：</strong></p><p>case 表达式 when val1 then result1 when val2 then result2 &mldr;.. else &mldr; end</p><p>把val的值变成result值</p><p><strong>第二种形式：</strong></p><p>case when 表达式1 then result1 when 表达式2 then result2 &mldr;.. else &mldr; end</p><h2 id=性别统计>性别统计<a hidden class=anchor aria-hidden=true href=#性别统计>#</a></h2><p>性别统计和统计职位没有太大的区别</p><h3 id=controller层-4>Controller层<a hidden class=anchor aria-hidden=true href=#controller层-4>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/empGenderData&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Result</span><span class=w> </span><span class=nf>getEmpGenderData</span><span class=p>(){</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>log</span><span class=p>.</span><span class=na>info</span><span class=p>(</span><span class=s>&#34;统计员工性别数量&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>Result</span><span class=p>.</span><span class=na>success</span><span class=p>(</span><span class=n>reportService</span><span class=p>.</span><span class=na>getEmpGenderData</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h3 id=service层-4>Service层<a hidden class=anchor aria-hidden=true href=#service层-4>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=nf>getEmpGenderData</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>List</span><span class=o>&lt;</span><span class=n>Map</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Object</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>mapList</span><span class=w> </span><span class=o>=</span><span class=w>  </span><span class=n>empMapper</span><span class=p>.</span><span class=na>countGender</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>mapList</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>这里因为需要传递的数据是：</p><p><img loading=lazy src=/images/Day10%e5%90%8e%e7%ab%afWeb%e5%ae%9e%e6%88%98%ef%bc%88%e5%91%98%e5%b7%a5%e7%ae%a1%e7%90%86%ef%bc%89.assets/1734569956146-bcb7f31b-1ed5-4cc7-9bbb-3e0c5b4453e7.png alt></p><p>所以直接传递回去一个List&lt;Map&lt;>&lt;&#187;就行，不需要额外的定义一个实体类</p><h3 id=mapper层-4>Mapper层<a hidden class=anchor aria-hidden=true href=#mapper层-4>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=o>&lt;!--</span><span class=w>    </span><span class=n>统计性别数量</span><span class=o>--&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>&lt;</span><span class=n>select</span><span class=w> </span><span class=n>id</span><span class=o>=</span><span class=s>&#34;countGender&#34;</span><span class=w> </span><span class=n>resultType</span><span class=o>=</span><span class=s>&#34;java.util.Map&#34;</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>select</span><span class=w> </span><span class=p>(</span><span class=k>if</span><span class=p>(</span><span class=n>gender</span><span class=o>=</span><span class=n>1</span><span class=p>,</span><span class=err>&#39;</span><span class=n>男性员工</span><span class=sc>&#39;,&#39;</span><span class=n>女性员工</span><span class=err>&#39;</span><span class=p>))</span><span class=w> </span><span class=err>&#39;</span><span class=n>name</span><span class=err>&#39;</span><span class=w>  </span><span class=p>,</span><span class=w> </span><span class=n>count</span><span class=p>(</span><span class=o>*</span><span class=p>)</span><span class=w> </span><span class=err>&#39;</span><span class=n>value</span><span class=err>&#39;</span><span class=w> </span><span class=n>from</span><span class=w> </span><span class=n>emp</span><span class=w> </span><span class=n>group</span><span class=w> </span><span class=n>by</span><span class=w> </span><span class=n>gender</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>&lt;/</span><span class=n>select</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>&lt;/</span><span class=n>mapper</span><span class=o>&gt;</span><span class=w>
</span></span></span></code></pre></div><p>MySQL中的if函数</p><p>只有两种条件时</p><p>if(条件, true_value, false_value)</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://wqnm1gb.github.io/tags/java-web/>Java Web</a></li></ul><nav class=paginav><a class=prev href=https://wqnm1gb.github.io/posts/day11%E5%90%8E%E7%AB%AFweb%E5%AE%9E%E6%88%98%E7%8F%AD%E7%BA%A7%E5%AD%A6%E5%91%98/><span class=title>« 上一页</span><br><span>Day11 后端Web实战（班级学员）</span>
</a><a class=next href=https://wqnm1gb.github.io/posts/day09%E5%90%8E%E7%AB%AFweb%E5%AE%9E%E6%88%98%E5%91%98%E5%B7%A5%E7%AE%A1%E7%90%86/><span class=title>下一页 »</span><br><span>Day09 后端Web实战（员工管理）</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://wqnm1gb.github.io/>三狗子的博客</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>