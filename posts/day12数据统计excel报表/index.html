<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Day12 数据统计、Excel报表 | 三狗子的博客</title>
<meta name=keywords content="苍穹外卖"><meta name=description content="Apache POI
Apache POl 是一个处理Miscrosoft Office各种文件格式的开源项目。简单来说就是，我们可以使用POI在Java 程序中对Miscrosoft Office各种文件进行读写操作。一般情况下，POl都是用于操作 Excel 文件。"><meta name=author content="冷漠三狗子丶"><link rel=canonical href=https://wqnm1gb.github.io/posts/day12%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1excel%E6%8A%A5%E8%A1%A8/><link crossorigin=anonymous href=/assets/css/stylesheet.3d688279d829dc24da48acd11f9e33ebea2f39c035e899e1bf4297d8b7aa89b9.css integrity="sha256-PWiCedgp3CTaSKzRH54z6+ovOcA16Jnhv0KX2Leqibk=" rel="preload stylesheet" as=style><link rel=icon href=https://wqnm1gb.github.io/images/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://wqnm1gb.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wqnm1gb.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://wqnm1gb.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://wqnm1gb.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://wqnm1gb.github.io/posts/day12%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1excel%E6%8A%A5%E8%A1%A8/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel=stylesheet><script type=text/javascript async src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["[[","]]"]],processEscapes:!0,processEnvironments:!0,skipTags:["script","noscript","style","textarea","pre"],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var e,t=MathJax.Hub.getAllJax();for(e=0;e<t.length;e+=1)t[e].SourceElement().parentNode.className+=" has-jax"})</script><style>code.has-jax{font:inherit;font-size:100%;background:inherit;border:inherit;color:#515151}</style><meta property="og:title" content="Day12 数据统计、Excel报表"><meta property="og:description" content="Apache POI
Apache POl 是一个处理Miscrosoft Office各种文件格式的开源项目。简单来说就是，我们可以使用POI在Java 程序中对Miscrosoft Office各种文件进行读写操作。一般情况下，POl都是用于操作 Excel 文件。"><meta property="og:type" content="article"><meta property="og:url" content="https://wqnm1gb.github.io/posts/day12%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1excel%E6%8A%A5%E8%A1%A8/"><meta property="og:image" content="https://wqnm1gb.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-03-20T11:09:41+08:00"><meta property="article:modified_time" content="2025-03-20T11:09:41+08:00"><meta property="og:site_name" content="三狗子的博客"><meta property="fb:admins" content="your-facebook-admin-id"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wqnm1gb.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Day12 数据统计、Excel报表","item":"https://wqnm1gb.github.io/posts/day12%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1excel%E6%8A%A5%E8%A1%A8/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Day12 数据统计、Excel报表","name":"Day12 数据统计、Excel报表","description":"Apache POI Apache POl 是一个处理Miscrosoft Office各种文件格式的开源项目。简单来说就是，我们可以使用POI在Java 程序中对Miscrosoft Office各种文件进行读写操作。一般情况下，POl都是用于操作 Excel 文件。\n","keywords":["苍穹外卖"],"articleBody":"Apache POI Apache POl 是一个处理Miscrosoft Office各种文件格式的开源项目。简单来说就是，我们可以使用POI在Java 程序中对Miscrosoft Office各种文件进行读写操作。一般情况下，POl都是用于操作 Excel 文件。\nApache POl 的应用场景：\n银行网银系统导出交易明细 各种业务系统导出Excel报表 批量导入业务数据 使用前需要导入Maven坐标\n\u003cdependency\u003e \u003cgroupId\u003eorg.apache.poi\u003c/groupId\u003e \u003cartifactId\u003epoi\u003c/artifactId\u003e \u003cversion\u003e3.16\u003c/version\u003e \u003c/dependency\u003e \u003cdependency\u003e \u003cgroupId\u003eorg.apache.poi\u003c/groupId\u003e \u003cartifactId\u003epoi-ooxml\u003c/artifactId\u003e \u003cversion\u003e3.16\u003c/version\u003e \u003c/dependency\u003e 快速入门 POI一开始创建会在内存中创建excel表\n创建一个sheet页，然后创建行对象（下标从0开始）1代表第二行\n在行上创建单元格\n使用POI输出一个excel文件\npublic class POITest { public static void write () throws Exception { // 在内存中创建一个Excel文件 XSSFWorkbook excel = new XSSFWorkbook(); // 创建一个sheet对象，指定sheet表格的名字是info XSSFSheet sheet = excel.createSheet(\"info\"); // 创建第二行对象 XSSFRow row = sheet.createRow(1); // 创建第2个单元格 row.createCell(1).setCellValue(\"姓名\"); row.createCell(2).setCellValue(\"城市\"); // 创建第3行对象 row = sheet.createRow(2); // 创建第2个单元格 row.createCell(1).setCellValue(\"飞机\"); row.createCell(2).setCellValue(\"北京\"); // 创建第4行对象 row = sheet.createRow(3); // 创建第2个单元格 row.createCell(1).setCellValue(\"舒克\"); row.createCell(2).setCellValue(\"上海\"); // 创建一个文件字节输出流 FileOutputStream fileOutputStream = new FileOutputStream(\"/Users/lengshao/Desktop/study/开发学习/苍穹外卖/excel/demo01.xlsx\"); excel.write(fileOutputStream); // 用完把流关闭 excel.close(); fileOutputStream.close(); } public static void main(String[] args) throws Exception { write(); } getLastNumber可以获取sheet中最后一行（有文字的行）的行号，也是从0开始的\nService中可以调用别的Service，用autowired修饰\n为什么这个代码能找到模板\nInputStream inputStream = this.getClass().getClassLoader().getResourceAsStream(\"template/运营数据报表模板.xlsx\"); Maven/Gradle 默认将 src/main/resources 下的内容复制到类路径根目录，因此 resources/template 最终对应类路径中的 /template。\ngetResourceAsStream(“template/运营数据报表模板.xlsx”)能正确找到\ngetResourceAsStream(\"/template/运营数据报表模板.xlsx\")不能正确找到\n原因如下：\nClassLoader 调用：路径不能以 / 开头，始终从类路径根目录开始查找。 Class 调用： 路径以 / 开头 → 从类路径根目录开始查找。 路径不以 / 开头 → 从当前类的包目录开始查找。 导出运营数据Excel报表 注意：当前接口没有返回数据，因为报表导出功能本质上是文件下载，服务端会通过输出流将Excel文件下载到客户端浏览器\n实现步骤：\n设计Excel模板文件 查询近30天的运营数据 将查询到的运营数据写入模板文件 通过输出流将Excel文件下载到客户端浏览器 一般复杂一点的表结构，都是先把表模板创建好，放在服务器里边，然后读取模板结构，对模板建构进行填充数据\nController层 /** * 导出运营数据报表 * @param httpServletResponse */ @GetMapping(\"/export\") @ApiOperation(\"导出报表\") public void exportExcel(HttpServletResponse httpServletResponse){ reportService.exportExcel(httpServletResponse); } Service层 /** * 导出运营数据报表 * @param httpServletResponse */ @Override public void exportExcel(HttpServletResponse httpServletResponse) { // 通过反射获取模板输入流 InputStream inputStream = this.getClass().getClassLoader().getResourceAsStream(\"template/运营数据报表模板.xlsx\"); // 统计30天的数据，开始时间是现在时间减去30天,结束时间是昨天 LocalDate begin = LocalDate.now().minusDays(30); LocalDate end = LocalDate.now().minusDays(1); // 获取要插入的数据 BusinessDataVO businessData = workspaceService.getBusinessData(LocalDateTime.of(begin, LocalTime.MIN), LocalDateTime.of(end, LocalTime.MAX)); try { // 插入到表格中 XSSFWorkbook excel =new XSSFWorkbook(inputStream); // 获取sheet表格 XSSFSheet sheet = excel.getSheet(\"Sheet1\"); // 获取第一行 XSSFRow row = sheet.getRow(1); // 插入时间数据 row.getCell(1).setCellValue(\"时间：\"+begin+\"--\"+end); // 插入概览数据 row = sheet.getRow(3); // 插入营业额数据 row.getCell(2).setCellValue(businessData.getTurnover()); // 插入订单完成率 row.getCell(4).setCellValue(businessData.getOrderCompletionRate()); // 插入新增用户数 row.getCell(6).setCellValue(businessData.getNewUsers()); row = sheet.getRow(4); // 插入有效订单 row.getCell(2).setCellValue(businessData.getValidOrderCount()); // 插入平均客单价 row.getCell(4).setCellValue(businessData.getUnitPrice()); // 写入明细数据 for (int i = 0; i \u003c 30; i++) { businessData = workspaceService.getBusinessData(LocalDateTime.of(begin, LocalTime.MIN), LocalDateTime.of(begin, LocalTime.MAX)); row = sheet.getRow(7+i); row.getCell(1).setCellValue(begin.toString()); row.getCell(2).setCellValue(businessData.getTurnover()); row.getCell(3).setCellValue(businessData.getValidOrderCount()); row.getCell(4).setCellValue(businessData.getOrderCompletionRate()); row.getCell(5).setCellValue(businessData.getUnitPrice()); row.getCell(6).setCellValue(businessData.getNewUsers()); begin = begin.plusDays(1); } // 把数据写给浏览器 // 获得输出流 ServletOutputStream outputStream = httpServletResponse.getOutputStream(); excel.write(outputStream); inputStream.close(); outputStream.close(); excel.close(); } catch (IOException e) { throw new RuntimeException(e); } } httpServletResponse用来获得输出流对象，让浏览器能够下载\n","wordCount":"1948","inLanguage":"zh","image":"https://wqnm1gb.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2025-03-20T11:09:41+08:00","dateModified":"2025-03-20T11:09:41+08:00","author":{"@type":"Person","name":"冷漠三狗子丶"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://wqnm1gb.github.io/posts/day12%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1excel%E6%8A%A5%E8%A1%A8/"},"publisher":{"@type":"Organization","name":"三狗子的博客","logo":{"@type":"ImageObject","url":"https://wqnm1gb.github.io/images/favicon.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://wqnm1gb.github.io/ accesskey=h title="主页 (Alt + H)"><img src=https://wqnm1gb.github.io/apple-touch-icon.png alt aria-label=logo height=35>主页</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://wqnm1gb.github.io/ title=三狗子的博客><span>首页</span></a></li><li><a href=https://wqnm1gb.github.io/archives/ title=归档><span>归档</span></a></li><li><a href=https://wqnm1gb.github.io/categories/ title=Categories><span>分类</span></a></li><li><a href=https://wqnm1gb.github.io/tags/ title=Tags><span>标签</span></a></li><li><a href=https://wqnm1gb.github.io/search/ title=搜索><span>搜索</span></a></li><li><a href=https://wqnm1gb.github.io/about/ title=关于><span>关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://wqnm1gb.github.io/>主页</a>&nbsp;»&nbsp;<a href=https://wqnm1gb.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Day12 数据统计、Excel报表</h1><div class=post-meta><span title='2025-03-20 11:09:41 +0800 +0800'>三月 20, 2025</span>&nbsp;·&nbsp;4 分钟&nbsp;·&nbsp;1948 字&nbsp;·&nbsp;冷漠三狗子丶</div></header><div class=post-content><h1 id=apache-poi>Apache POI<a hidden class=anchor aria-hidden=true href=#apache-poi>#</a></h1><p>Apache POl 是一个处理Miscrosoft Office各种文件格式的开源项目。简单来说就是，我们可以使用<strong>POI在Java 程序中对Miscrosoft Office各种文件进行读写操作</strong>。一般情况下，POl都是用于<strong>操作 Excel 文件</strong>。</p><p><img loading=lazy src=/images/Day12%e6%95%b0%e6%8d%ae%e7%bb%9f%e8%ae%a1%e3%80%81Excel%e6%8a%a5%e8%a1%a8.assets/1741084027225-23dd8a14-8a62-44e8-af70-f2fafdc83574.png alt></p><p>Apache POl 的应用场景：</p><ul><li>银行网银系统导出交易明细</li><li>各种业务系统导出Excel报表</li><li>批量导入业务数据</li></ul><p>使用前需要导入Maven坐标</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=o>&lt;</span><span class=n>dependency</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>&lt;</span><span class=n>groupId</span><span class=o>&gt;</span><span class=n>org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>poi</span><span class=o>&lt;/</span><span class=n>groupId</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>&lt;</span><span class=n>artifactId</span><span class=o>&gt;</span><span class=n>poi</span><span class=o>&lt;/</span><span class=n>artifactId</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>&lt;</span><span class=n>version</span><span class=o>&gt;</span><span class=n>3</span><span class=p>.</span><span class=na>16</span><span class=o>&lt;/</span><span class=n>version</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>&lt;/</span><span class=n>dependency</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>&lt;</span><span class=n>dependency</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>&lt;</span><span class=n>groupId</span><span class=o>&gt;</span><span class=n>org</span><span class=p>.</span><span class=na>apache</span><span class=p>.</span><span class=na>poi</span><span class=o>&lt;/</span><span class=n>groupId</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>&lt;</span><span class=n>artifactId</span><span class=o>&gt;</span><span class=n>poi</span><span class=o>-</span><span class=n>ooxml</span><span class=o>&lt;/</span><span class=n>artifactId</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=o>&lt;</span><span class=n>version</span><span class=o>&gt;</span><span class=n>3</span><span class=p>.</span><span class=na>16</span><span class=o>&lt;/</span><span class=n>version</span><span class=o>&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=o>&lt;/</span><span class=n>dependency</span><span class=o>&gt;</span><span class=w>
</span></span></span></code></pre></div><h1 id=快速入门>快速入门<a hidden class=anchor aria-hidden=true href=#快速入门>#</a></h1><p>POI一开始创建会在内存中创建excel表</p><p>创建一个sheet页，然后创建行对象（下标从0开始）1代表第二行</p><p>在行上创建单元格</p><p>使用POI输出一个excel文件</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>POITest</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>write</span><span class=w> </span><span class=p>()</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 在内存中创建一个Excel文件</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>XSSFWorkbook</span><span class=w> </span><span class=n>excel</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>XSSFWorkbook</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 创建一个sheet对象，指定sheet表格的名字是info</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>XSSFSheet</span><span class=w> </span><span class=n>sheet</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>excel</span><span class=p>.</span><span class=na>createSheet</span><span class=p>(</span><span class=s>&#34;info&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 创建第二行对象</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>XSSFRow</span><span class=w> </span><span class=n>row</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sheet</span><span class=p>.</span><span class=na>createRow</span><span class=p>(</span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 创建第2个单元格</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>row</span><span class=p>.</span><span class=na>createCell</span><span class=p>(</span><span class=n>1</span><span class=p>).</span><span class=na>setCellValue</span><span class=p>(</span><span class=s>&#34;姓名&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>row</span><span class=p>.</span><span class=na>createCell</span><span class=p>(</span><span class=n>2</span><span class=p>).</span><span class=na>setCellValue</span><span class=p>(</span><span class=s>&#34;城市&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 创建第3行对象</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>row</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sheet</span><span class=p>.</span><span class=na>createRow</span><span class=p>(</span><span class=n>2</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 创建第2个单元格</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>row</span><span class=p>.</span><span class=na>createCell</span><span class=p>(</span><span class=n>1</span><span class=p>).</span><span class=na>setCellValue</span><span class=p>(</span><span class=s>&#34;飞机&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>row</span><span class=p>.</span><span class=na>createCell</span><span class=p>(</span><span class=n>2</span><span class=p>).</span><span class=na>setCellValue</span><span class=p>(</span><span class=s>&#34;北京&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 创建第4行对象</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>row</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sheet</span><span class=p>.</span><span class=na>createRow</span><span class=p>(</span><span class=n>3</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 创建第2个单元格</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>row</span><span class=p>.</span><span class=na>createCell</span><span class=p>(</span><span class=n>1</span><span class=p>).</span><span class=na>setCellValue</span><span class=p>(</span><span class=s>&#34;舒克&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>row</span><span class=p>.</span><span class=na>createCell</span><span class=p>(</span><span class=n>2</span><span class=p>).</span><span class=na>setCellValue</span><span class=p>(</span><span class=s>&#34;上海&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 创建一个文件字节输出流</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>FileOutputStream</span><span class=w> </span><span class=n>fileOutputStream</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>FileOutputStream</span><span class=p>(</span><span class=s>&#34;/Users/lengshao/Desktop/study/开发学习/苍穹外卖/excel/demo01.xlsx&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>excel</span><span class=p>.</span><span class=na>write</span><span class=p>(</span><span class=n>fileOutputStream</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 用完把流关闭</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>excel</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>fileOutputStream</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>write</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>getLastNumber可以获取sheet中最后一行（有文字的行）的行号，也是从0开始的</p><p>Service中可以调用别的Service，用autowired修饰</p><p>为什么这个代码能找到模板</p><p><img loading=lazy src=/images/Day12%e6%95%b0%e6%8d%ae%e7%bb%9f%e8%ae%a1%e3%80%81Excel%e6%8a%a5%e8%a1%a8.assets/1741064451447-de15057f-83bd-4a46-88c9-acd98c01a57a.png alt></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>InputStream</span><span class=w> </span><span class=n>inputStream</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>getClass</span><span class=p>().</span><span class=na>getClassLoader</span><span class=p>().</span><span class=na>getResourceAsStream</span><span class=p>(</span><span class=s>&#34;template/运营数据报表模板.xlsx&#34;</span><span class=p>);</span><span class=w>
</span></span></span></code></pre></div><p>Maven/Gradle 默认将 <code>&lt;font style="color:rgb(64, 64, 64);">src/main/resources&lt;/font></code> 下的内容复制到类路径根目录，因此 <code>&lt;font style="color:rgb(64, 64, 64);">resources/template&lt;/font></code> 最终对应类路径中的 <code>&lt;font style="color:rgb(64, 64, 64);">/template&lt;/font></code>。</p><p></p><p>getResourceAsStream(&ldquo;template/运营数据报表模板.xlsx&rdquo;)能正确找到</p><p>getResourceAsStream("/template/运营数据报表模板.xlsx")不能正确找到</p><p>原因如下：</p><ul><li><strong>ClassLoader 调用</strong>：路径不能以 <code>&lt;font style="color:rgb(64, 64, 64);">/&lt;/font></code> 开头，始终从类路径根目录开始查找。</li><li><strong>Class 调用</strong>：<ul><li>路径以 <code>&lt;font style="color:rgb(64, 64, 64);">/&lt;/font></code> 开头 → 从类路径根目录开始查找。</li><li>路径不以 <code>&lt;font style="color:rgb(64, 64, 64);">/&lt;/font></code> 开头 → 从当前类的包目录开始查找。</li></ul></li></ul><p></p><p></p><h1 id=导出运营数据excel报表>导出运营数据Excel报表<a hidden class=anchor aria-hidden=true href=#导出运营数据excel报表>#</a></h1><p>注意：当前接口没有返回数据，因为报表导出功能本质上是文件下载，服务端会通过输出流将Excel文件下载到客户端浏览器</p><p>实现步骤：</p><ol><li>设计Excel模板文件</li><li>查询近30天的运营数据</li><li>将查询到的运营数据写入模板文件</li><li>通过输出流将Excel文件下载到客户端浏览器</li></ol><p>一般复杂一点的表结构，都是先把表模板创建好，放在服务器里边，然后读取模板结构，对模板建构进行填充数据</p><h2 id=controller层>Controller层<a hidden class=anchor aria-hidden=true href=#controller层>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w> </span><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * 导出运营数据报表
</span></span></span><span class=line><span class=cl><span class=cm>     * @param httpServletResponse
</span></span></span><span class=line><span class=cl><span class=cm>     */</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@GetMapping</span><span class=p>(</span><span class=s>&#34;/export&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@ApiOperation</span><span class=p>(</span><span class=s>&#34;导出报表&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>exportExcel</span><span class=p>(</span><span class=n>HttpServletResponse</span><span class=w> </span><span class=n>httpServletResponse</span><span class=p>){</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>reportService</span><span class=p>.</span><span class=na>exportExcel</span><span class=p>(</span><span class=n>httpServletResponse</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><h2 id=service层>Service层<a hidden class=anchor aria-hidden=true href=#service层>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w> </span><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm>     * 导出运营数据报表
</span></span></span><span class=line><span class=cl><span class=cm>     * @param httpServletResponse
</span></span></span><span class=line><span class=cl><span class=cm>     */</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nd>@Override</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>exportExcel</span><span class=p>(</span><span class=n>HttpServletResponse</span><span class=w> </span><span class=n>httpServletResponse</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 通过反射获取模板输入流</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>InputStream</span><span class=w> </span><span class=n>inputStream</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>getClass</span><span class=p>().</span><span class=na>getClassLoader</span><span class=p>().</span><span class=na>getResourceAsStream</span><span class=p>(</span><span class=s>&#34;template/运营数据报表模板.xlsx&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 统计30天的数据，开始时间是现在时间减去30天,结束时间是昨天</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>LocalDate</span><span class=w> </span><span class=n>begin</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>LocalDate</span><span class=p>.</span><span class=na>now</span><span class=p>().</span><span class=na>minusDays</span><span class=p>(</span><span class=n>30</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>LocalDate</span><span class=w> </span><span class=n>end</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>LocalDate</span><span class=p>.</span><span class=na>now</span><span class=p>().</span><span class=na>minusDays</span><span class=p>(</span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c1>// 获取要插入的数据</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=n>BusinessDataVO</span><span class=w> </span><span class=n>businessData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>workspaceService</span><span class=p>.</span><span class=na>getBusinessData</span><span class=p>(</span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>of</span><span class=p>(</span><span class=n>begin</span><span class=p>,</span><span class=w> </span><span class=n>LocalTime</span><span class=p>.</span><span class=na>MIN</span><span class=p>),</span><span class=w> </span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>of</span><span class=p>(</span><span class=n>end</span><span class=p>,</span><span class=w> </span><span class=n>LocalTime</span><span class=p>.</span><span class=na>MAX</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=k>try</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 插入到表格中</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>XSSFWorkbook</span><span class=w> </span><span class=n>excel</span><span class=w> </span><span class=o>=</span><span class=k>new</span><span class=w> </span><span class=n>XSSFWorkbook</span><span class=p>(</span><span class=n>inputStream</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 获取sheet表格</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>XSSFSheet</span><span class=w> </span><span class=n>sheet</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>excel</span><span class=p>.</span><span class=na>getSheet</span><span class=p>(</span><span class=s>&#34;Sheet1&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 获取第一行</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>XSSFRow</span><span class=w> </span><span class=n>row</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sheet</span><span class=p>.</span><span class=na>getRow</span><span class=p>(</span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 插入时间数据</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>row</span><span class=p>.</span><span class=na>getCell</span><span class=p>(</span><span class=n>1</span><span class=p>).</span><span class=na>setCellValue</span><span class=p>(</span><span class=s>&#34;时间：&#34;</span><span class=o>+</span><span class=n>begin</span><span class=o>+</span><span class=s>&#34;--&#34;</span><span class=o>+</span><span class=n>end</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 插入概览数据</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>row</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sheet</span><span class=p>.</span><span class=na>getRow</span><span class=p>(</span><span class=n>3</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 插入营业额数据</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>row</span><span class=p>.</span><span class=na>getCell</span><span class=p>(</span><span class=n>2</span><span class=p>).</span><span class=na>setCellValue</span><span class=p>(</span><span class=n>businessData</span><span class=p>.</span><span class=na>getTurnover</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 插入订单完成率</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>row</span><span class=p>.</span><span class=na>getCell</span><span class=p>(</span><span class=n>4</span><span class=p>).</span><span class=na>setCellValue</span><span class=p>(</span><span class=n>businessData</span><span class=p>.</span><span class=na>getOrderCompletionRate</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 插入新增用户数</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>row</span><span class=p>.</span><span class=na>getCell</span><span class=p>(</span><span class=n>6</span><span class=p>).</span><span class=na>setCellValue</span><span class=p>(</span><span class=n>businessData</span><span class=p>.</span><span class=na>getNewUsers</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>row</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sheet</span><span class=p>.</span><span class=na>getRow</span><span class=p>(</span><span class=n>4</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 插入有效订单</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>row</span><span class=p>.</span><span class=na>getCell</span><span class=p>(</span><span class=n>2</span><span class=p>).</span><span class=na>setCellValue</span><span class=p>(</span><span class=n>businessData</span><span class=p>.</span><span class=na>getValidOrderCount</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 插入平均客单价</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>row</span><span class=p>.</span><span class=na>getCell</span><span class=p>(</span><span class=n>4</span><span class=p>).</span><span class=na>setCellValue</span><span class=p>(</span><span class=n>businessData</span><span class=p>.</span><span class=na>getUnitPrice</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 写入明细数据</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>30</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>businessData</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>workspaceService</span><span class=p>.</span><span class=na>getBusinessData</span><span class=p>(</span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>of</span><span class=p>(</span><span class=n>begin</span><span class=p>,</span><span class=w> </span><span class=n>LocalTime</span><span class=p>.</span><span class=na>MIN</span><span class=p>),</span><span class=w> </span><span class=n>LocalDateTime</span><span class=p>.</span><span class=na>of</span><span class=p>(</span><span class=n>begin</span><span class=p>,</span><span class=w> </span><span class=n>LocalTime</span><span class=p>.</span><span class=na>MAX</span><span class=p>));</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>row</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>sheet</span><span class=p>.</span><span class=na>getRow</span><span class=p>(</span><span class=n>7</span><span class=o>+</span><span class=n>i</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>row</span><span class=p>.</span><span class=na>getCell</span><span class=p>(</span><span class=n>1</span><span class=p>).</span><span class=na>setCellValue</span><span class=p>(</span><span class=n>begin</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>row</span><span class=p>.</span><span class=na>getCell</span><span class=p>(</span><span class=n>2</span><span class=p>).</span><span class=na>setCellValue</span><span class=p>(</span><span class=n>businessData</span><span class=p>.</span><span class=na>getTurnover</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>row</span><span class=p>.</span><span class=na>getCell</span><span class=p>(</span><span class=n>3</span><span class=p>).</span><span class=na>setCellValue</span><span class=p>(</span><span class=n>businessData</span><span class=p>.</span><span class=na>getValidOrderCount</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>row</span><span class=p>.</span><span class=na>getCell</span><span class=p>(</span><span class=n>4</span><span class=p>).</span><span class=na>setCellValue</span><span class=p>(</span><span class=n>businessData</span><span class=p>.</span><span class=na>getOrderCompletionRate</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>row</span><span class=p>.</span><span class=na>getCell</span><span class=p>(</span><span class=n>5</span><span class=p>).</span><span class=na>setCellValue</span><span class=p>(</span><span class=n>businessData</span><span class=p>.</span><span class=na>getUnitPrice</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>row</span><span class=p>.</span><span class=na>getCell</span><span class=p>(</span><span class=n>6</span><span class=p>).</span><span class=na>setCellValue</span><span class=p>(</span><span class=n>businessData</span><span class=p>.</span><span class=na>getNewUsers</span><span class=p>());</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=n>begin</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>begin</span><span class=p>.</span><span class=na>plusDays</span><span class=p>(</span><span class=n>1</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 把数据写给浏览器</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c1>// 获得输出流</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>ServletOutputStream</span><span class=w> </span><span class=n>outputStream</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>httpServletResponse</span><span class=p>.</span><span class=na>getOutputStream</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>excel</span><span class=p>.</span><span class=na>write</span><span class=p>(</span><span class=n>outputStream</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>inputStream</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>outputStream</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=n>excel</span><span class=p>.</span><span class=na>close</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w> </span><span class=k>catch</span><span class=w> </span><span class=p>(</span><span class=n>IOException</span><span class=w> </span><span class=n>e</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=k>throw</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>RuntimeException</span><span class=p>(</span><span class=n>e</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>httpServletResponse用来获得输出流对象，让浏览器能够下载</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://wqnm1gb.github.io/tags/%E8%8B%8D%E7%A9%B9%E5%A4%96%E5%8D%96/>苍穹外卖</a></li></ul><nav class=paginav><a class=next href=https://wqnm1gb.github.io/posts/day11%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1%E5%9B%BE%E5%BD%A2%E6%8A%A5%E8%A1%A8/><span class=title>下一页 »</span><br><span>Day11 数据统计、图形报表</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://wqnm1gb.github.io/>三狗子的博客</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="复制";function s(){t.innerHTML="已复制！",setTimeout(()=>{t.innerHTML="复制"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>